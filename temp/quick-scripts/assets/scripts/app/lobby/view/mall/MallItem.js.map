{"version":3,"sources":["MallItem.js"],"names":["BaseObj","require","http","enumType","diamond","roomCard","cc","Class","extends","properties","onLoad","diamondSprite","find","diamondNumLabel","presentDiamondLabel","presentBg","rmbLabel","init","param","itemNumber","number","MallView","setData","data","string","name","type","spriteFrame","getDiamondImages","money","give_amount","active","onBuyButton","log","pay","js","requestBuyRoomCard","sendRequest","user_id","gUserData","uid","exchange_id","id","ret","status","eventMgr","emit","bind"],"mappings":";;;;;;AAAA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;AACA,IAAIC,OAAOD,QAAQ,MAAR,CAAX;AACA,IAAIE,WAAW;AACXC,aAAU,CADC;AAEXC,cAAW;AAFA,CAAf;;AAKAC,GAAGC,KAAH,CAAS;AACLC,aAASR,OADJ;;AAGLS,gBAAY,EAHP;;AAOLC,YAAQ,kBAAY;AAChB,aAAKC,aAAL,GAAqB,KAAKC,IAAL,CAAU,eAAV,CAArB;AACA,aAAKC,eAAL,GAAuB,KAAKD,IAAL,CAAU,iBAAV,CAAvB;AACA,aAAKE,mBAAL,GAA2B,KAAKF,IAAL,CAAU,qBAAV,CAA3B;AACA,aAAKG,SAAL,GAAiB,KAAKH,IAAL,CAAU,WAAV,CAAjB;AACA,aAAKI,QAAL,GAAgB,KAAKJ,IAAL,CAAU,UAAV,CAAhB;AACH,KAbI;;AAeLK,UAAM,cAAUC,KAAV,EAAiB;AACnB,aAAKC,UAAL,GAAkBD,MAAME,MAAxB;AACA,aAAKC,QAAL,GAAgBH,MAAMG,QAAtB;AACH,KAlBI;AAmBL;;;;;;;;;;;;;;;;;AAiBAC,aAAS,iBAAUC,IAAV,EAAgB;AACrB,aAAKA,IAAL,GAAYA,IAAZ;AACA;AACA,aAAKV,eAAL,CAAqBW,MAArB,GAA8BD,KAAKE,IAAnC;AACA;;AAEA,YAAItB,SAASC,OAAT,IAAoB,KAAKsB,IAA7B,EAAmC;AAAE;AACjC,iBAAKf,aAAL,CAAmBgB,WAAnB,GAAiC,KAAKN,QAAL,CAAcO,gBAAd,CAA+B,KAAKT,UAApC,CAAjC;AACA,iBAAKH,QAAL,CAAcQ,MAAd,GAAuB,MAAMD,KAAKM,KAAlC;AACA,gBAAIN,KAAKO,WAAL,IAAoB,CAAxB,EAA2B;AACvB,qBAAKf,SAAL,CAAegB,MAAf,GAAwB,KAAxB;AACA;AACH;AACD,iBAAKjB,mBAAL,CAAyBU,MAAzB,GAAkC,OAAOD,KAAKO,WAAZ,GAA0B,KAA5D;AACA,iBAAKf,SAAL,CAAegB,MAAf,GAAwB,IAAxB;AACH,SATD,MAUK,IAAI5B,SAASE,QAAT,IAAqB,KAAKqB,IAA9B,EAAoC;AAAE;AACvC,iBAAKV,QAAL,CAAcQ,MAAd,GAAuB,MAAMD,KAAKnB,OAAlC;AACA,iBAAKW,SAAL,CAAegB,MAAf,GAAwB,KAAxB;AACH;AACJ,KAxDI;;AA0DLC,iBAAa,uBAAY;AACrB1B,WAAG2B,GAAH,CAAO,sBAAsB,KAAKd,UAAlC;AACA,YAAIhB,SAASC,OAAT,IAAoB,KAAKsB,IAA7B,EAAmC;AAC/B,iBAAKL,QAAL,CAAca,GAAd,CAAkBH,MAAlB,GAA2B,IAA3B;AACA,iBAAKV,QAAL,CAAca,GAAd,CAAkBC,EAAlB,CAAqBb,OAArB,CAA6B,KAAKC,IAAlC;AACH,SAHD,MAIK,IAAIpB,SAASE,QAAT,IAAqB,KAAKqB,IAA9B,EAAoC;AACrC,iBAAKU,kBAAL;AACH;AACJ,KAnEI;;AAqEL;AACAA,wBAAoB,8BAAY;AAC5BlC,aAAKmC,WAAL,CAAiB,gBAAjB,EAAmC,EAACC,SAAUC,UAAUC,GAArB,EAA0BC,aAAc,KAAKlB,IAAL,CAAUmB,EAAlD,EAAnC,EAA0F,UAAUC,GAAV,EAAeC,MAAf,EAAuB;AAC7GtC,eAAG2B,GAAH,CAAOU,GAAP;AACArC,eAAGuC,QAAH,CAAYC,IAAZ,CAAiB,kBAAjB;AACH,SAHyF,CAGxFC,IAHwF,CAGnF,IAHmF,CAA1F;AAIH;AA3EI,CAAT","file":"MallItem.js","sourceRoot":"../../../../../../../../assets/scripts/app/lobby/view/mall","sourcesContent":["var BaseObj = require(\"BaseObj\")\nvar http = require(\"Http\")\nvar enumType = {\n    diamond : 1,\n    roomCard : 2,\n}\n\ncc.Class({\n    extends: BaseObj,\n\n    properties: {\n\n    },\n\n    onLoad: function () {\n        this.diamondSprite = this.find(\"diamondSprite\")\n        this.diamondNumLabel = this.find(\"diamondNumLabel\")\n        this.presentDiamondLabel = this.find(\"presentDiamondLabel\")\n        this.presentBg = this.find(\"presentBg\")\n        this.rmbLabel = this.find(\"rmbLabel\")\n    },\n\n    init: function (param) {\n        this.itemNumber = param.number\n        this.MallView = param.MallView\n    },\n    /*\n        id\tint\t\n        name\tstring\t名称\n        amount\tint\t数量\n        type\tint\t渠道类型：1苹果;2安卓\n        money\tstring\t金额\n        flag\tint\t钻石类型1:原价,2:优惠\n        status\tint\t状态0失效1正常\n        sort\tint\t排序\n        give_amount\tint\t赠送数量(为0表示没有赠送)\n        give_starttime\tint\t赠送开始时间\n        give_endtime int\t赠送结束时间\n        isgive\tint\t是否赠送0否1是\n        created_at\tint\t创建时间\n        display\tint\t 是否删除0删除1未删除\n        discount string\t代理价\n    */\n    setData: function (data) {\n        this.data = data\n        // this.diamondNumLabel.string = data.diamondNum + \"个钻石\"\n        this.diamondNumLabel.string = data.name\n        // this.rmbLabel.string = \"¥\" + data.rmb\n\n        if (enumType.diamond == this.type) { //钻石item\n            this.diamondSprite.spriteFrame = this.MallView.getDiamondImages(this.itemNumber)\n            this.rmbLabel.string = \"¥\" + data.money\n            if (data.give_amount == 0) {\n                this.presentBg.active = false\n                return\n            }\n            this.presentDiamondLabel.string = \"赠送\" + data.give_amount + \"颗钻石\"\n            this.presentBg.active = true\n        }\n        else if (enumType.roomCard == this.type) { //房卡\n            this.rmbLabel.string = \"¥\" + data.diamond\n            this.presentBg.active = false\n        }\n    },\n\n    onBuyButton: function () {\n        cc.log(\"---onBuyButton---\" + this.itemNumber)\n        if (enumType.diamond == this.type) {\n            this.MallView.pay.active = true\n            this.MallView.pay.js.setData(this.data)\n        }\n        else if (enumType.roomCard == this.type) {\n            this.requestBuyRoomCard()\n        }\n    },\n\n    //购买房卡\n    requestBuyRoomCard: function () {\n        http.sendRequest(\"/game/exchange\", {user_id : gUserData.uid, exchange_id : this.data.id}, function (ret, status) {\n            cc.log(ret)\n            cc.eventMgr.emit(\"updatePlayerInfo\")\n        }.bind(this))\n    }\n});\n"]}