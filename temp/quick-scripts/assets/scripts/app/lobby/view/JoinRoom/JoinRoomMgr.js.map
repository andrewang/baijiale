{"version":3,"sources":["JoinRoomMgr.js"],"names":["BaseMgr","require","ruleMap","Code","cc","Class","extends","properties","onLoad","_super","log","view","arguments","cb","event","eventMgr","addEvent","requestJoin","rid","sceneNode","js","showLoadingView","setTimeout","groupId","gUserData","dingdingData","gameData","netMgr","request","gid","ret","code","OK","hideLoadingView","exec","roomInfo","room_info","director","loadScene","bind","onDestroy","removeEvent"],"mappings":";;;;;;AAAA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;AACA,IAAIC,UAAUD,QAAQ,kBAAR,EAA4BC,OAA1C;AACA,IAAIC,OAAOF,QAAQ,MAAR,CAAX;;AAEAG,GAAGC,KAAH,CAAS;AACPC,WAASN,OADF;;AAGPO,cAAY,EAHL;;AAOP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAC,UAAQ,kBAAY;AAClB,SAAKC,MAAL;;AAEAL,OAAGM,GAAH,CAAO,iBAAP;AACA,SAAKC,IAAL,GAAYC,UAAU,CAAV,CAAZ;AACA,SAAKC,EAAL,GAAU,UAAUC,KAAV,EAAiB;AACzBV,SAAGM,GAAH,CAAO,MAAP,EAAeI,KAAf;AACD,KAFD;AAGAV,OAAGW,QAAH,CAAYC,QAAZ,CAAqB,MAArB,EAA6B,KAAKH,EAAlC;AACD,GAxBM;;AA0BPI,eAAa,qBAAUC,GAAV,EAAe;AAC1Bd,OAAGe,SAAH,CAAaC,EAAb,CAAgBC,eAAhB;AACAC,eAAW,YAAY;AACrB,UAAIC,UAAU,CAAd;AACA,UAAIC,UAAUC,YAAV,CAAuBC,QAA3B,EAAqC;AACnCH,kBAAUC,UAAUC,YAAV,CAAuBC,QAAvB,CAAgCH,OAA1C;AACD;AACDnB,SAAGuB,MAAH,CAAUC,OAAV,CAAkB,WAAlB,EAA+B,EAAEV,KAAKA,GAAP,EAAYW,KAAM,CAAlB,EAA/B,EAAqD,UAAUC,GAAV,EAAe;AAClE1B,WAAGM,GAAH,CAAO,WAAP,EAAoBoB,GAApB;AACA,YAAIA,IAAIC,IAAJ,IAAY5B,KAAK6B,EAArB,EAAyB;AACvB5B,aAAGe,SAAH,CAAaC,EAAb,CAAgBa,eAAhB;AACD;AACD7B,WAAGuB,MAAH,CAAUO,IAAV,CAAeJ,GAAf,EAAoB,YAAY;AAC9BN,oBAAUW,QAAV,GAAqBL,IAAIM,SAAzB;AACAhC,aAAGiC,QAAH,CAAYC,SAAZ,CAAsB,WAAtB;AACD,SAHmB,CAGlBC,IAHkB,CAGb,IAHa,CAApB;AAID,OAToD,CASnDA,IATmD,CAS9C,IAT8C,CAArD;AAUD,KAfU,CAeTA,IAfS,CAeJ,IAfI,CAAX,EAec,EAfd;AAgBD,GA5CM;;AA8CPC,aAAW,qBAAY;AACrB,SAAK/B,MAAL;AACAL,OAAGW,QAAH,CAAY0B,WAAZ,CAAwB,MAAxB,EAAgC,KAAK5B,EAArC;AACD;;AAjDM,CAAT","file":"JoinRoomMgr.js","sourceRoot":"../../../../../../../../assets/scripts/app/lobby/view/JoinRoom","sourcesContent":["var BaseMgr = require(\"BaseMgr\")\nvar ruleMap = require(\"CreateRoomConfig\").ruleMap\nvar Code = require(\"Code\");\n\ncc.Class({\n  extends: BaseMgr,\n\n  properties: {\n\n  },\n\n  // ctor: function () {\n  //   cc.log(\"ctor\")\n  //   this.view = arguments[0]\n  //   cc.eventMgr.addEvent(\"test\", function (event) {\n  //     cc.log(\"test\", event)\n  // })\n  // },\n\n  onLoad: function () {\n    this._super()\n\n    cc.log(\"JoinRoom:onLoad\")\n    this.view = arguments[0]\n    this.cb = function (event) {\n      cc.log(\"test\", event)\n    }\n    cc.eventMgr.addEvent(\"test\", this.cb)\n  },\n\n  requestJoin: function (rid) {\n    cc.sceneNode.js.showLoadingView()\n    setTimeout(function () {\n      var groupId = 0\n      if (gUserData.dingdingData.gameData) {\n        groupId = gUserData.dingdingData.gameData.groupId\n      }\n      cc.netMgr.request(\"room_join\", { rid: rid, gid : 0}, function (ret) {\n        cc.log(\"room_join\", ret);\n        if (ret.code != Code.OK) {\n          cc.sceneNode.js.hideLoadingView()\n        }\n        cc.netMgr.exec(ret, function () {\n          gUserData.roomInfo = ret.room_info\n          cc.director.loadScene(\"GameScene\")\n        }.bind(this))\n      }.bind(this))\n    }.bind(this), 10)\n  },\n\n  onDestroy: function () {\n    this._super()\n    cc.eventMgr.removeEvent(\"test\", this.cb)\n  },\n\n});\n"]}