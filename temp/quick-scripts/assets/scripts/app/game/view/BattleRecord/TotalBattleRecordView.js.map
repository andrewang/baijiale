{"version":3,"sources":["TotalBattleRecordView.js"],"names":["BaseView","require","http","cc","Class","extends","properties","onLoad","_super","svLayout","find","noItemsLabel","on","reqGetData","self","data","page","iPage","uid","gUserData","sendRequest","ret","log","netMgr","exec","addItem","room_record_info_list","test","i","item","instantiate","res","js","getComponent","parent","node","setTimeout","getContentSize","height","_layoutSize","setContentSize","width","bind","active","length","setData","show","removeAllChildren","totalHeight","opacity","runAction","fadeTo"],"mappings":"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","file":"TotalBattleRecordView.js","sourceRoot":"../../../../../../../../assets/scripts/app/game/view/BattleRecord","sourcesContent":["var BaseView = require(\"BaseView\")\nvar http = require(\"Http\")\n\ncc.Class({\n    extends: BaseView,\n\n    properties: {\n\n    },\n\n    onLoad: function () {\n        this._super()\n        this.svLayout = this.find(\"svLayout\")\n        this.noItemsLabel = this.find(\"noItemsLabel\")\n\n        this.find(\"scrollview\").on('scroll-to-bottom', function () {\n            this.reqGetData()\n        }, this)\n\n        // this.test()\n    },\n\n    reqGetData: function () {\n        var self = this\n        var data = { page: this.iPage , uid: gUserData.uid}\n        http.sendRequest(\"/game/room_record\", data, function (ret) {\n            cc.log(ret)\n            cc.netMgr.exec(ret, function () {\n                self.addItem(ret.room_record_info_list)\n                self.iPage ++\n            })\n        })\n    },\n\n    test: function () {\n        for (var i = 0; i < 12; i++) {\n            var item = cc.instantiate(cc.res[\"prefabs/battleRecord/TotalBattleRecordItem\"])\n            item.js = item.getComponent(\"TotalBattleRecordItem\")\n            item.parent = this.svLayout.node\n        }\n        setTimeout(function () {\n            cc.log(\"2222\", this.svLayout, this.svLayout.node.getContentSize().height, this.svLayout._layoutSize.height)\n            this.find(\"sv_content\").setContentSize({ width: 960, height: this.svLayout.node.getContentSize().height - 120})\n        }.bind(this), 200)\n    },\n\n    addItem: function (room_record_info_list) {\n        this.noItemsLabel.node.active = false\n        for (var i = 0; i < room_record_info_list.length; i++) {\n            var data = room_record_info_list[i]\n            var item = cc.instantiate(cc.res[\"prefabs/battleRecord/TotalBattleRecordItem\"])\n            item.js = item.getComponent(\"TotalBattleRecordItem\")\n            item.parent = this.svLayout.node\n            item.js.setData(data)\n        }\n        setTimeout(function () {\n            this.find(\"sv_content\").setContentSize({ width: 960, height: this.svLayout.node.getContentSize().height - 120})\n        }.bind(this), 200)\n    },\n\n    show: function () {\n        this._super()\n\n        this.svLayout.node.removeAllChildren()\n        this.totalHeight = 0\n        this.iPage = 1\n        this.reqGetData()\n        if (this.noItemsLabel.node.active)\n        {\n            this.noItemsLabel.node.opacity = 0\n            this.noItemsLabel.node.runAction(cc.fadeTo(1, 255))\n        }\n    },\n\n});\n"]}