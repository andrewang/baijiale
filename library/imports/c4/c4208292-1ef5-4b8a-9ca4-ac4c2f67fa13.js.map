{"version":3,"sources":["../../../../../../assets/scripts/app/game/assets/scripts/app/game/GameMgr.js"],"names":["BaseMgr","require","Code","clientBetState","clientCardIndex","stateEnmu","timeConfig","cc","Class","extends","properties","onLoad","_isRoomOwner","_myData","_otherPlayerDatas","_roomOwnerData","jipaiZhuangUid","jipaiXianUid","curJipaiPlayerUid","curStateTime","totalBetNumList","curJushu","flipList","initListener","gameMgr","syncTimeInterval","setInterval","netMgr","request","ct","ret","exec","curTime","Date","parse","timeOffset","st","update","handleData","eventMgr","addEvent","onRoomLeave","onRoomJoin","onGameStateChanged","on_room_game_cut_cards","on_room_game_betting","on_room_game_send_cards","on_room_game_compare_cards","on_room_game_squeeze_cards","on_room_game_squeeze_cards_pos","on_room_game_squeeze_cards_square","on_room_game_mend_cards","on_settle_accounts_inning","on_settle_accounts_finish","on_settle_accounts_midway","on_room_game_trans_permi","on_room_chat","on_room_game_clear_bet","on_room_game_cut_cards_pos","onDestroy","_super","removeEvent","clearInterval","reset","view","updateTotalBetInfo","delaySqueezeData","game_status_begin_time","gUserData","roomInfo","game_status","status","find","active","BETTING","BETTING_DELAY","isRoomOwner","CUT_CARDS","room_status","musicMgr","playEffect","node","betLeftTime","BETTING_TIME_LIMIT","getCurTime","i","player","data","launchTimer","BETTING_DELAY_TIME_LIMIT","hideTimer","TRANS_PERMI","transLeftTime","TRANS_PERMI_TIME_LIMIT","showPowerObjTimer","isExitOneCardOnMove","btnFlip","state","btnFlipZhuang","btnFlipXian","handleSqueeze","jiLeftTime","SQUEEZE_CARDS_TIME_LIMIT","getPlayerByUid","uid","index","pos","card","cardList","getSqueezeType","squeezeType","threeD","threeDCardJs","js","isRotate","rotate","ratioVal","slider","x","y","touchNode","position","push","checkFlip","checkHideFlipBtn","list","getNeedSqueezeCard","length","getComponent","isOnFlip","bind","splice","flip","compareCards","dealCards","wayBillView","hide","singleResultView","buCards","value","getTotalChipValueArea","setChipsOnArea","jetton","banker_squeeze_permi_uid","setBankerDelegate","player_squeeze_permi_uid","setXianDelegate","settle","isMiddle","chipSettle","clone","state_info","user_win_list","user_profit","win_jetton","updateGoldNum","owner","owner_win_jetton","playResultEffect","setTimeout","openView","setData","waybill_info","chess_cards_way_list","show","setJushu","inning_count","checkPlayerChipFallAni","playChipFallAni","seatData","getSeatDataByUID","seatID","calSeatId","seat","init","clientSeatId","seat_info","seat_info_list","showDiscard","open_cards","key","user_base_info","getPlayerInfoByUID","info","setRoomOwner","ownerSeatData","myId","otherId","ownerOffset","offset","setPlayerDatas","playerDatas","tableNums","removeByIndex","reqRoomLeave","backToLobbyScene","reqRoomClose","reqStartGame","reqCutCards","reqBet","reqClearBet","reqStopBet","handleRoomInfo","srv_curr_time","room_close_info","launch_time","total_bet_banker","total_bet_player","total_bet_tie","total_bet_banker_pair","total_bet_player_pair","buPai_xian","playerCardsList","player_cards_list","cards","clientIndex","showBack","player_open_cards_list","serverIndex","squeezeComplete","bankerCardsList","buPai_zhuang","banker_cards_list","banker_open_cards_list","SQUEEZE_CARDS","curr_squeeze_cards_square","unopen_cards_list","reqTransCardPermisssion","code","OK","move","pb_timer","showMoveFirstTips","showBubble","type","words","num","totalJushu","room_setup_info","inning_num","string","clearAllSmallChip","sys","isBrowser","squeeze_cards","setCutControlPos","audioEngine","stopAll","director","loadScene","checkDelaySqueeze"],"mappings":"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","file":"GameMgr.js","sourceRoot":"../../../../../../assets/scripts/app/game","sourcesContent":["var BaseMgr = require(\"BaseMgr\")\nvar Code = require(\"Code\")\n//后端下注类型转客户端数据\nvar clientBetState = require(\"GameConfig\").clientBetState\nvar clientCardIndex = require(\"GameConfig\").clientCardIndex\nvar stateEnmu = require(\"GameConfig\").stateEnmu\nvar timeConfig = require(\"GameConfig\").timeConfig\n\ncc.Class({\n  extends: BaseMgr,\n\n  properties: {\n\n  },\n\n  onLoad: function () {\n    //数据\n    this._isRoomOwner = false\n    //自己的座位数据，如果自己是房主，则和房主座位数据一样\n    this._myData = null\n    //其他玩家的座位数据\n    this._otherPlayerDatas = null\n    //房主座位数据\n    this._roomOwnerData = null\n    //庄家挤牌权的玩家的UID\n    this.jipaiZhuangUid = null\n    //闲家挤牌权的玩家的UID\n    this.jipaiXianUid = null\n    //当前拥有挤牌权的玩家UID\n    this.curJipaiPlayerUid = null\n    //当前阶段的开始时间戳\n    this.curStateTime = null\n    //下注数量统计 1：庄 2：闲 3：和 4：庄对 5：闲对\n    this.totalBetNumList = [0, 0, 0, 0, 0, 0]\n    this.curJushu = 0\n    this.flipList = [] //翻牌队列\n\n\n    this.initListener()\n    cc.gameMgr = this\n\n    //同步时间\n    this.syncTimeInterval = setInterval(function () {\n      cc.netMgr.request(\"user_ntp_net_time\", { ct: 0 }, function (ret) {\n        cc.netMgr.exec(ret, function () {\n          var curTime = Date.parse(new Date()) / 1000\n          timeOffset = curTime - ret.st\n        })\n      })\n    }, 1000)\n  },\n\n  update: function () {\n    cc.netMgr.handleData()\n  },\n\n  initListener: function () {\n    cc.eventMgr.addEvent(\"on_room_leave\", this.onRoomLeave, this)\n    cc.eventMgr.addEvent(\"on_room_join\", this.onRoomJoin, this)\n    cc.eventMgr.addEvent(\"on_room_game_status_change\", this.onGameStateChanged, this)\n    cc.eventMgr.addEvent(\"on_room_game_cut_cards\", this.on_room_game_cut_cards, this)\n    cc.eventMgr.addEvent(\"on_room_game_betting\", this.on_room_game_betting, this)\n    cc.eventMgr.addEvent(\"on_room_game_send_cards\", this.on_room_game_send_cards, this)\n    cc.eventMgr.addEvent(\"on_room_game_compare_cards\", this.on_room_game_compare_cards, this)\n    cc.eventMgr.addEvent(\"on_room_game_squeeze_cards\", this.on_room_game_squeeze_cards, this)\n    cc.eventMgr.addEvent(\"on_room_game_squeeze_cards_pos\", this.on_room_game_squeeze_cards_pos, this)\n    cc.eventMgr.addEvent(\"on_room_game_squeeze_cards_square\", this.on_room_game_squeeze_cards_square, this)\n    cc.eventMgr.addEvent(\"on_room_game_mend_cards\", this.on_room_game_mend_cards, this)\n    cc.eventMgr.addEvent(\"on_settle_accounts_inning\", this.on_settle_accounts_inning, this)\n    cc.eventMgr.addEvent(\"on_settle_accounts_finish\", this.on_settle_accounts_finish, this)\n    cc.eventMgr.addEvent(\"on_settle_accounts_midway\", this.on_settle_accounts_midway, this)\n    cc.eventMgr.addEvent(\"on_room_game_trans_permi\", this.on_room_game_trans_permi, this)\n    cc.eventMgr.addEvent(\"on_room_chat\", this.on_room_chat, this)\n    cc.eventMgr.addEvent(\"on_room_game_clear_bet\", this.on_room_game_clear_bet, this)\n    cc.eventMgr.addEvent(\"on_room_game_cut_cards_pos\", this.on_room_game_cut_cards_pos, this)\n  },\n\n  onDestroy: function () {\n    this._super()\n    cc.eventMgr.removeEvent(\"on_room_leave\", this.onRoomLeave)\n    cc.eventMgr.removeEvent(\"on_room_join\", this.onRoomJoin)\n    cc.eventMgr.removeEvent(\"on_room_game_status_change\", this.onGameStateChanged, this)\n    cc.eventMgr.removeEvent(\"on_room_game_cut_cards\", this.on_room_game_cut_cards, this)\n    cc.eventMgr.removeEvent(\"on_room_game_betting\", this.on_room_game_betting, this)\n    cc.eventMgr.removeEvent(\"on_room_game_send_cards\", this.on_room_game_send_cards, this)\n    cc.eventMgr.removeEvent(\"on_room_game_compare_cards\", this.on_room_game_compare_cards, this)\n    cc.eventMgr.removeEvent(\"on_room_game_squeeze_cards\", this.on_room_game_squeeze_cards, this)\n    cc.eventMgr.removeEvent(\"on_room_game_squeeze_cards_pos\", this.on_room_game_squeeze_cards_pos, this)\n    cc.eventMgr.removeEvent(\"on_room_game_squeeze_cards_square\", this.on_room_game_squeeze_cards_square, this)\n    cc.eventMgr.removeEvent(\"on_room_game_mend_cards\", this.on_room_game_mend_cards, this)\n    cc.eventMgr.removeEvent(\"on_settle_accounts_inning\", this.on_settle_accounts_inning, this)\n    cc.eventMgr.removeEvent(\"on_settle_accounts_finish\", this.on_settle_accounts_finish, this)\n    cc.eventMgr.removeEvent(\"on_settle_accounts_midway\", this.on_settle_accounts_midway, this)\n    cc.eventMgr.removeEvent(\"on_room_game_trans_permi\", this.on_room_game_trans_permi, this)\n    cc.eventMgr.removeEvent(\"on_room_chat\", this.on_room_chat, this)\n    cc.eventMgr.removeEvent(\"on_room_game_clear_bet\", this.on_room_game_clear_bet, this)\n    cc.eventMgr.removeEvent(\"on_room_game_cut_cards_pos\", this.on_room_game_cut_cards_pos, this)\n\n    clearInterval(this.syncTimeInterval)\n  },\n\n  //重置牌局\n  reset: function () {\n    this.jipaiZhuangUid = null\n    this.jipaiXianUid = null\n    this.curJipaiPlayerUid = null\n\n    this.view.reset()\n    this.totalBetNumList = [0, 0, 0, 0, 0, 0]\n    this.view.updateTotalBetInfo()\n\n    this.flipList = [] //翻牌队列\n    this.delaySqueezeData = null\n  },\n\n  onGameStateChanged: function (ret) {\n    this.curStateTime = ret.game_status_begin_time\n    gUserData.roomInfo.game_status = ret.status\n    this.view.find(\"nodeChip\").active = (stateEnmu.BETTING == ret.status || stateEnmu.BETTING_DELAY == ret.status) && !this.isRoomOwner()\n    // cc.log(\"======时间 status, curStateTime, clientTime\", ret.status, this.curStateTime, getCurTime())\n    //切牌\n    if (stateEnmu.CUT_CARDS == ret.status) {\n      gUserData.roomInfo.room_status = \"start\"\n      cc.musicMgr.playEffect(\"please_cut_card.mp3\")\n      this.view.find(\"nodeBtnOwner\").active = false\n      this.view.find(\"nodeBtnPlayer\").active = false\n      this.view.find(\"start_bg\").node.active = false\n      this.view.find(\"cutPoker\").active = true\n    } else if (stateEnmu.BETTING == ret.status) {\n      cc.musicMgr.playEffect(\"please_bet.mp3\")\n      // this.reset()\n      //启动下注倒计时\n      var betLeftTime = timeConfig.BETTING_TIME_LIMIT - (getCurTime() - this.curStateTime)\n      for (var i = 1; i <= 9; i++) {\n        var player = this.view.find(\"player\" + i)\n        if (player.data) {\n          player.launchTimer(betLeftTime, timeConfig.BETTING_TIME_LIMIT)\n        }\n      }\n    } else if (stateEnmu.BETTING_DELAY == ret.status) {\n      var betLeftTime = timeConfig.BETTING_DELAY_TIME_LIMIT - (getCurTime() - this.curStateTime)\n      for (var i = 1; i <= 9; i++) {\n        var player = this.view.find(\"player\" + i)\n        if (player.data) {\n          player.launchTimer(betLeftTime, timeConfig.BETTING_DELAY_TIME_LIMIT)\n        }\n      }\n    } else {\n      for (var i = 1; i <= 9; i++) {\n        var player = this.view.find(\"player\" + i)\n        if (player.data) {\n          player.hideTimer()\n        }\n      }\n    }\n\n    // 只有在转移挤牌权阶段才能显示那个转移的东西\n    if (stateEnmu.TRANS_PERMI == ret.status) {\n      //启动转移挤牌倒计时\n      var transLeftTime = timeConfig.TRANS_PERMI_TIME_LIMIT - (getCurTime() - this.curStateTime)\n      for (var i = 1; i <= 9; i++) {\n        var player = this.view.find(\"player\" + i)\n        if (player.data) {\n          player.launchTimer(transLeftTime, timeConfig.TRANS_PERMI_TIME_LIMIT)\n        }\n      }\n      // if (this.jipaiZhuangUid) {\n      //   this.view.getPlayerByUid(this.jipaiZhuangUid).pb_timer.active = true\n      // }\n      // if (this.jipaiXianUid) {\n      //   this.view.getPlayerByUid(this.jipaiXianUid).pb_timer.active = true\n      // }\n      this.showPowerObjTimer()\n\n    } else {\n\n    }\n  },\n\n  //开始挤牌\n  on_room_game_squeeze_cards_square: function (ret) {\n    if (this.view.isExitOneCardOnMove()) {\n      this.delaySqueezeData = ret\n      return\n    }\n    //庄挤牌\n    var btnFlip = null\n    if (1 == ret.state) {\n      this.curJipaiPlayerUid = this.jipaiZhuangUid\n      btnFlip = this.view.btnFlipZhuang\n    }\n    else {\n      this.curJipaiPlayerUid = this.jipaiXianUid\n      btnFlip = this.view.btnFlipXian\n    }\n    this.view.handleSqueeze(ret)\n    //倒计时    \n    for (var i = 1; i <= 9; i++) {\n      var player = this.view.find(\"player\" + i)\n      if (player.data) {\n        player.hideTimer()\n      }\n    }\n    var jiLeftTime = timeConfig.SQUEEZE_CARDS_TIME_LIMIT - (getCurTime() - this.curStateTime)\n    var player = this.view.getPlayerByUid(this.curJipaiPlayerUid)\n    if (player) {\n      player.launchTimer(jiLeftTime, timeConfig.SQUEEZE_CARDS_TIME_LIMIT)\n    }\n    if (this.curJipaiPlayerUid == gUserData.uid) {\n      btnFlip.launchTimer(jiLeftTime, timeConfig.SQUEEZE_CARDS_TIME_LIMIT)\n    }\n  },\n\n  //挤牌位置同步\n  on_room_game_squeeze_cards_pos: function (ret) {\n    var index = ret.pos.index\n    var card = this.view.cardList[index]\n    var pos = ret.pos\n    if (this.getSqueezeType() == squeezeType.threeD) {\n      var threeDCardJs = card.js.threeDCardJs\n      if (threeDCardJs && pos.isRotate) {\n        threeDCardJs.rotate()\n      }\n      else if (threeDCardJs && pos.ratioVal) {\n        threeDCardJs.ratioVal = pos.ratioVal\n      }\n    } else if (this.getSqueezeType() == squeezeType.slider) {\n      if (pos.x && pos.y) {\n        var touchNode = card.js.find(\"cardMove\").node\n        touchNode.position = { x: pos.x, y: pos.y }\n      }\n    }\n  },\n\n  //挤牌时下发\n  on_room_game_squeeze_cards: function (ret) {\n    //翻开所有牌\n    if (null == ret.index) {\n      for (var i = 1; i <= 2; i++) {\n        var index = clientCardIndex[ret.state][i]\n        this.flipList.push(index)\n      }\n    } else {\n      var index = clientCardIndex[ret.state][ret.index]\n      this.flipList.push(index)\n    }\n    this.checkFlip()\n    // this.checkHideFlipBtn()\n  },\n\n  checkHideFlipBtn: function () {\n    var list = this.view.getNeedSqueezeCard()\n\n    if (list.length == 0) {\n      this.view.btnFlipXian.getComponent(\"FlipBtn\").hideTimer()\n      this.view.btnFlipZhuang.getComponent(\"FlipBtn\").hideTimer()\n    }\n  },\n\n  checkFlip: function () {\n    //是否有扑克在翻牌中\n    var isOnFlip = function () {\n      for (var i = 1; i <= 6; i++) {\n        if (this.view.cardList[i].js.isOnFlip()) {\n          return true\n        }\n      }\n      return false\n    }.bind(this)\n\n    if (isOnFlip()) {\n      return\n    }\n    if (this.flipList.length != 0) {\n      var index = this.flipList[0]\n      this.flipList.splice(0, 1)\n      this.view.cardList[index].js.flip()\n    }\n    this.checkHideFlipBtn()\n  },\n\n  //比牌\n  on_room_game_compare_cards: function (ret) {\n    this.view.compareCards(ret)\n  },\n\n  on_room_game_send_cards: function (ret) {\n    if (0 == this.curJushu) {\n      cc.musicMgr.playEffect(\"feipai.mp3\")\n    }\n    this.view.dealCards(ret)\n    if (this.wayBillView) {\n      this.wayBillView.hide()\n    }\n    if (this.singleResultView) {\n      this.singleResultView.hide()\n    }\n  },\n\n  on_room_game_mend_cards: function (ret) {\n    this.view.buCards(ret)\n  },\n\n  //下注\n  on_room_game_betting: function (ret) {\n    var player = this.view.getPlayerByUid(ret.uid)\n    // var chip = player.addSmallChip(ret.jetton, ret.state)\n    // var parent = this.view.getPlayerBetParent(player.getClientSeatId(), ret.state)\n    // chip.parent = parent\n    var value = player.getTotalChipValueArea(ret.state)\n    player.setChipsOnArea(value + ret.jetton, ret.state)\n\n    this.totalBetNumList[ret.state] += ret.jetton\n    this.view.updateTotalBetInfo()\n\n    this.jipaiZhuangUid = ret.banker_squeeze_permi_uid\n    this.view.setBankerDelegate(ret.banker_squeeze_permi_uid)\n    this.jipaiXianUid = ret.player_squeeze_permi_uid\n    this.view.setXianDelegate(ret.player_squeeze_permi_uid)\n\n    //策划说只有自己下注才需要播放音效\n    if (ret.uid == gUserData.uid) {\n      cc.musicMgr.playEffect(\"bet.mp3\")\n    }\n  },\n\n  settle: function (ret, isMiddle) {\n    for (var i = 1; i <= 9; i++) {\n      this.view.find(\"player\" + i).js.chipSettle(clone(ret.state_info), isMiddle)\n    }\n    for (var i = 0; i < ret.user_win_list.length; i++) {\n      var user_profit = ret.user_win_list[i]\n      var player = this.view.getPlayerByUid(user_profit.uid)\n      //如果玩家输了，不用更新数量，因为在下注的时候已经扣除了筹码\n      if (user_profit.win_jetton >= 0) {\n        player.updateGoldNum(user_profit.win_jetton)\n      }\n      //如果玩家自身这盘赢了，播放赢的音效\n      if (user_profit.uid == gUserData.uid && user_profit.win_jetton > 0) {\n        cc.musicMgr.playEffect(\"win.mp3\")\n      }\n    }\n    var owner = this.view.find(\"player0\")\n    owner.updateGoldNum(ret.owner_win_jetton)\n  },\n\n  //单局游戏结算\n  on_settle_accounts_inning: function (ret) {\n    this.settle(ret)\n    cc.musicMgr.playResultEffect(ret)\n    setTimeout(function () {\n      var view = this.view.openView(\"prefabs/wayBill/WayBillView\")\n      this.wayBillView = view\n      view.setData(ret.waybill_info.chess_cards_way_list)\n      if (this.isRoomOwner()) {\n        view.hide()\n        var singleResultView = this.view.openView(\"prefabs/singleResult/SingleResultView\")\n        this.singleResultView = singleResultView\n        singleResultView.setData(ret)\n      } else {\n        view.show()\n      }\n      this.setJushu(ret.inning_count)\n      //重置牌局\n      this.reset()\n    }.bind(this), 2000)\n\n    //这局赢的人需要播放特效\n    var checkPlayerChipFallAni = function () {\n      for (var i = 0; i < ret.user_win_list.length; i++) {\n        var user_profit = ret.user_win_list[i]\n        var player = this.view.getPlayerByUid(user_profit.uid)\n        if (user_profit.win_jetton > 0) {\n          player.playChipFallAni()\n        }\n      }\n      if (ret.owner_win_jetton > 0) {\n        var owner = this.view.find(\"player0\")\n        owner.playChipFallAni()\n      }\n    }.bind(this)\n    checkPlayerChipFallAni()\n    // if (ret.state_info.state_list && ret.state_info.state_list.indexOf(1) != -1) {\n    //   this.view.node_quanxian_zhuang.getComponent(\"PowerObj\").flip(checkPlayerChipFallAni)\n    // }\n    // if (ret.state_info.state_list && ret.state_info.state_list.indexOf(2) != -1) {\n    //   this.view.node_quanxian_xian.getComponent(\"PowerObj\").flip(checkPlayerChipFallAni)\n    // }\n  },\n\n  //中途结算\n  on_settle_accounts_midway: function (ret) {\n    this.settle(ret, true)\n  },\n\n  //游戏总结算\n  on_settle_accounts_finish: function (ret) {\n    var view = this.view.openView(\"prefabs/totalResult/TotalResultView\")\n    view.setData(clone(ret))\n  },\n\n  onRoomLeave: function (ret) {\n    var seatData = this.getSeatDataByUID(ret.uid)\n    var seatID = this.calSeatId(this._myData.seat, seatData.seat)\n    var player = this.view.find(\"player\" + seatID).js\n    player.init(player.clientSeatId)\n  },\n\n  onRoomJoin: function (ret) {\n    var seatID = this.calSeatId(this._myData.seat, ret.seat_info.seat)\n    this.view.find(\"player\" + seatID).js.setData(ret.seat_info)\n    this._otherPlayerDatas.push(ret.seat_info)\n    //转为数组，因为后端发来的空table转到JS是字典\n    gUserData.roomInfo.seat_info_list = clone(gUserData.roomInfo.seat_info_list)\n    gUserData.roomInfo.seat_info_list.push(ret.seat_info)\n  },\n\n  on_room_game_cut_cards: function (ret) {\n    cc.musicMgr.playEffect(\"xiao_pai.mp3\")\n    this.view.find(\"cutControl\").position = { x: ret.pos, y: this.view.find(\"cutControl\").position.y }\n    setTimeout(function () {\n      this.view.find(\"cutPoker\").active = false\n      this.view.find(\"pokerDiscard\").active = true\n      this.view.showDiscard(ret.open_cards)\n    }.bind(this), 1000)\n  },\n\n  getSeatDataByUID: function (uid) {\n    for (var key in this._otherPlayerDatas) {\n      if (uid == this._otherPlayerDatas[key].user_base_info.uid) {\n        return this._otherPlayerDatas[key]\n      }\n    }\n    if (uid == this._myData.user_base_info.uid) {\n      return this._myData\n    }\n    if (uid == this._roomOwnerData.user_base_info.uid) {\n      return this._roomOwnerData\n    }\n  },\n\n  getPlayerInfoByUID: function (uid) {\n    var info = this.getSeatDataByUID(uid)\n    return info.user_base_info\n  },\n\n  setRoomOwner: function (ownerSeatData) {\n    this._roomOwnerData = ownerSeatData\n    if (ownerSeatData.user_base_info.uid == gUserData.uid) {\n      this._isRoomOwner = true\n    }\n    else {\n      this._isRoomOwner = false\n    }\n    this.view.find(\"player0\").js.setData(ownerSeatData)\n  },\n\n  isRoomOwner: function () {\n    return this._isRoomOwner\n  },\n\n  //计算UI上的座位ID\n  calSeatId: function (myId, otherId) {\n    var ownerOffset = 0\n    if (!this.isRoomOwner()) {\n      ownerOffset = 1\n    }\n    var offset = otherId - myId\n    if (offset < 0) {\n\n      return offset + 9 + ownerOffset\n    }\n    else {\n      return offset + ownerOffset\n    }\n  },\n\n  //设置玩家数据\n  setPlayerDatas: function (playerDatas) {\n    this._otherPlayerDatas = playerDatas\n    if (!this.isRoomOwner()) {\n      for (var i = 0; i < tableNums(playerDatas); i++) {\n        if (gUserData.uid == playerDatas[i].user_base_info.uid) {\n          this._myData = playerDatas[i]\n          removeByIndex(playerDatas, i)\n          break\n        }\n      }\n      // this.view.playerList[1].getComponent(\"Player\").setData(this._myData)\n      this.view.find(\"player1\").js.setData(this._myData)\n    }\n    else {\n      this._myData = this._roomOwnerData\n    }\n\n    //显示其他玩家的UI\n    for (var i = 0; i < tableNums(playerDatas); i++) {\n      var seatData = playerDatas[i]\n      var seatID = this.calSeatId(this._myData.seat, seatData.seat)\n      // this.view.playerList[seatID].getComponent(\"Player\").setData(seatData)\n      this.view.find(\"player\" + seatID).js.setData(seatData)\n    }\n  },\n\n  reqRoomLeave: function () {\n    cc.netMgr.request(\"room_leave\", {}, function (ret) {\n      cc.netMgr.exec(ret, function () {\n        // cc.common.showMsgBox({ type: 1, msg: \"已离开房间\" })\n        cc.gameMgr.backToLobbyScene()\n      })\n    })\n  },\n\n  reqRoomClose: function () {\n    cc.netMgr.request(\"room_close_launch\", {}, function (ret) {\n      cc.netMgr.exec(ret, function () {\n      })\n    })\n  },\n\n  reqStartGame: function () {\n    cc.netMgr.request(\"room_game_start\", {}, function (ret) {\n      cc.netMgr.exec(ret, function () {\n        // gUserData.roomInfo.room_status = \"start\"\n      })\n    })\n  },\n  //切牌\n  reqCutCards: function (data) {\n    cc.netMgr.request(\"room_game_cut_cards\", data, function (ret) {\n      cc.netMgr.exec(ret, function () {\n      })\n    })\n  },\n\n  //下注\n  reqBet: function (data) {\n    cc.netMgr.request(\"room_game_betting\", data, function (ret) {\n      cc.netMgr.exec(ret, function () {\n      })\n    })\n  },\n\n  //清除下注\n  reqClearBet: function () {\n    cc.netMgr.request(\"room_game_clear_bet\", {}, function (ret) {\n      cc.netMgr.exec(ret, function () {\n      })\n    })\n  },\n\n  //停止下注\n  reqStopBet: function () {\n    cc.netMgr.request(\"room_game_stop_bet\", {}, function (ret) {\n      cc.netMgr.exec(ret, function () {\n      })\n    })\n  },\n\n  //处理刚进入房间或者重连时候的房间数据 重点：1筹码状况 2卡牌状况 3挤牌权 4路单\n  handleRoomInfo: function () {\n    //设置时间差\n    var curTime = Date.parse(new Date()) / 1000\n    this.curStateTime = gUserData.roomInfo.game_status_begin_time\n    // cc.log(\"设置时间差 srvTime, curStateTime, curTime\", gUserData.roomInfo.srv_curr_time, this.curStateTime, curTime)\n    timeOffset = curTime - gUserData.roomInfo.srv_curr_time\n\n    this.onGameStateChanged({ status: gUserData.roomInfo.game_status, game_status_begin_time: gUserData.roomInfo.game_status_begin_time })\n    var room_close_info = gUserData.roomInfo.room_close_info\n    if (room_close_info.launch_time != 0) {\n      var view = this.view.openView(\"prefabs/dismissRoom/DismissRoomView\")\n      view.setData(room_close_info)\n    }\n\n    this.totalBetNumList[1] = gUserData.roomInfo.total_bet_banker\n    this.totalBetNumList[2] = gUserData.roomInfo.total_bet_player\n    this.totalBetNumList[3] = gUserData.roomInfo.total_bet_tie\n    this.totalBetNumList[4] = gUserData.roomInfo.total_bet_banker_pair\n    this.totalBetNumList[5] = gUserData.roomInfo.total_bet_player_pair\n    this.view.updateTotalBetInfo()\n\n    //设置挤牌权\n    // if (0 != gUserData.roomInfo.banker_squeeze_permi_uid) {\n    this.jipaiZhuangUid = gUserData.roomInfo.banker_squeeze_permi_uid\n    this.view.setBankerDelegate(this.jipaiZhuangUid)\n    // }\n    // if (0 != gUserData.roomInfo.player_squeeze_permi_uid) {\n    this.jipaiXianUid = gUserData.roomInfo.player_squeeze_permi_uid\n    this.view.setXianDelegate(this.jipaiXianUid)\n    // }\n\n    //设置闲方的牌\n    var buPai_xian = false\n    var playerCardsList = []\n    playerCardsList.push(0) //这么做是为了以1开始的索引，因为后端其他数据会发以1开始的索引\n    for (var i = 0; i < gUserData.roomInfo.player_cards_list.length; i++) {\n      var cards = gUserData.roomInfo.player_cards_list[i]\n      playerCardsList.push(clone(cards))\n    }\n    for (var i = 1; i < playerCardsList.length; i++) {\n      var data = playerCardsList[i]\n      var clientIndex = clientCardIndex[2][i]\n      var card = this.view.cardList[clientIndex]\n      card.js.setData(data, clientIndex)\n      card.active = true\n      card.js.showBack()\n      // card.position = this.view.find(\"posCard\" + clientIndex).position\n      if(playerCardsList.length == 4){\n        card.position = this.view.find(\"dieposCard\" + clientIndex).node.position\n        buPai_xian = true\n      }\n      else{\n        card.position = this.view.find(\"posCard\" + clientIndex).node.position\n      }\n    }\n    //闲方已打开的牌\n    for (var i = 0; i < gUserData.roomInfo.player_open_cards_list.length; i++) {\n      var serverIndex = gUserData.roomInfo.player_open_cards_list[i]\n      var index = clientCardIndex[2][serverIndex]\n      var card = this.view.cardList[index]\n      card.js.squeezeComplete(buPai_xian)\n    }\n\n    //设置庄家的牌\n    var bankerCardsList = []\n    var buPai_zhuang = false\n    bankerCardsList.push(0) //这么做是为了以1开始的索引，因为后端其他数据会发以1开始的索引\n    for (var i = 0; i < gUserData.roomInfo.banker_cards_list.length; i++) {\n      var cards = gUserData.roomInfo.banker_cards_list[i]\n      bankerCardsList.push(clone(cards))\n    }\n    for (var i = 1; i < bankerCardsList.length; i++) {\n      var data = bankerCardsList[i]\n      var clientIndex = clientCardIndex[1][i]\n      var card = this.view.cardList[clientIndex]\n      card.js.setData(data, clientIndex)\n      card.active = true\n      card.js.showBack()\n      // card.position = this.view.find(\"posCard\" + clientIndex).position\n      if (bankerCardsList.length == 4) {\n        card.position = this.view.find(\"dieposCard\" + clientIndex).node.position\n        buPai_zhuang = true\n      }\n      else{\n        card.position = this.view.find(\"posCard\" + clientIndex).node.position\n      }\n    }\n    //庄家已打开的牌\n    for (var i = 0; i < gUserData.roomInfo.banker_open_cards_list.length; i++) {\n      var serverIndex = gUserData.roomInfo.banker_open_cards_list[i]\n      var index = clientCardIndex[1][serverIndex]\n      var card = this.view.cardList[index]\n      card.js.squeezeComplete(buPai_zhuang)\n    }\n\n    //挤牌阶段\n    if (stateEnmu.SQUEEZE_CARDS == gUserData.roomInfo.game_status) {\n      this.on_room_game_squeeze_cards_square({ state: gUserData.roomInfo.curr_squeeze_cards_square, unopen_cards_list: gUserData.roomInfo.unopen_cards_list })\n    }\n  },\n\n  //转移挤牌权\n  reqTransCardPermisssion: function (data) {\n    cc.netMgr.request(\"room_game_trans_permi\", data, function (ret) {\n      //转移挤牌权失败，挤牌权回去原玩家身上\n      if (ret.code != Code.OK) {\n        if (this.jipaiZhuangUid) {\n          var player = this.view.getPlayerByUid(this.jipaiZhuangUid)\n          this.view.find(\"node_quanxian_zhuang\").move(player.node.position)\n        }\n        if (this.jipaiXianUid) {\n          var player = this.view.getPlayerByUid(this.jipaiXianUid)\n          this.view.find(\"node_quanxian_xian\").move(player.node.position)\n        }\n      }\n      cc.netMgr.exec(ret, function () {\n      })\n    }.bind(this))\n  },\n\n  on_room_game_trans_permi: function (ret) {\n    // cc.log(\"转让挤牌权\", ret.banker_squeeze_permi_uid, ret.player_squeeze_permi_uid)\n    this.jipaiZhuangUid = ret.banker_squeeze_permi_uid\n    this.view.setBankerDelegate(ret.banker_squeeze_permi_uid)\n    this.jipaiXianUid = ret.player_squeeze_permi_uid\n    this.view.setXianDelegate(ret.player_squeeze_permi_uid)\n\n    this.showPowerObjTimer()\n  },\n\n  showPowerObjTimer: function () {\n    //有挤牌权的人显示倒计时\n    for (var i = 1; i <= 9; i++) {\n      var player = this.view.find(\"player\" + i)\n      if (player.data) {\n        player.pb_timer.active = false\n      }\n    }\n    if (this.jipaiZhuangUid) {\n      this.view.getPlayerByUid(this.jipaiZhuangUid).pb_timer.active = true\n    }\n    if (this.jipaiXianUid) {\n      this.view.getPlayerByUid(this.jipaiXianUid).pb_timer.active = true\n    }\n    //自己有挤牌权显示提示\n    if (this.jipaiZhuangUid == cc.gameMgr._myData.user_base_info.uid || this.jipaiXianUid == cc.gameMgr._myData.user_base_info.uid) {\n      this.view.find(\"player1\").showMoveFirstTips()\n    }\n  },\n\n  on_room_chat: function (ret) {\n    var player = this.view.getPlayerByUid(ret.uid)\n    player.showBubble({ type: ret.type, words: ret.words })\n  },\n\n  setJushu: function (num) {\n    this.curJushu = num\n    var totalJushu = 0\n    // if (1 == gUserData.roomInfo.room_setup_info.inning_limit_type) {\n    //   totalJushu = 20\n    // }\n    // else if (2 == gUserData.roomInfo.room_setup_info.inning_limit_type) {\n    //   totalJushu = 50\n    // }\n    // else if (3 == gUserData.roomInfo.room_setup_info.inning_limit_type) {\n    //   totalJushu = 80\n    // }\n    totalJushu = gUserData.roomInfo.room_setup_info.inning_num\n    this.view.find(\"txtJushu\").string = \"局数：\" + num + \"/\" + totalJushu\n  },\n\n  on_room_game_clear_bet: function (ret) {\n    var player = this.view.getPlayerByUid(ret.uid)\n    player.clearAllSmallChip()\n\n    this.jipaiZhuangUid = ret.banker_squeeze_permi_uid\n    this.view.setBankerDelegate(ret.banker_squeeze_permi_uid)\n    this.jipaiXianUid = ret.player_squeeze_permi_uid\n    this.view.setXianDelegate(ret.player_squeeze_permi_uid)\n  },\n\n  //获取挤牌类型\n  getSqueezeType: function () {\n    //浏览器暂不支持3D挤牌\n    if (cc.sys.isBrowser) {\n      return squeezeType.slider\n    }\n    else {\n      return gUserData.roomInfo.room_setup_info.squeeze_cards\n    }\n  },\n\n  //切牌杆位置同步\n  on_room_game_cut_cards_pos: function (ret) {\n    this.view.setCutControlPos(ret.pos)\n  },\n\n  backToLobbyScene: function () {\n    cc.audioEngine.stopAll()\n    cc.director.loadScene(\"LobbyScene\")\n  },\n\n  //检查是否有延时挤牌要处理\n  checkDelaySqueeze: function () {\n    if (!this.view.isExitOneCardOnMove() && this.delaySqueezeData) {\n      this.on_room_game_squeeze_cards_square(this.delaySqueezeData)\n      this.delaySqueezeData = null\n    }\n\n  },\n\n});\n"]}