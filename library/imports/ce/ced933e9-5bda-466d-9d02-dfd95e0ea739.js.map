{"version":3,"sources":["../../../../../../../../assets/scripts/app/lobby/view/JoinRoom/assets/scripts/app/lobby/view/JoinRoom/RoomInfoView.js"],"names":["BaseView","require","serverRoomDesc","Code","cc","Class","extends","properties","onLoad","setData","data","nameString","owner_base_info","name","getNameStringCount","substr","find","string","i18n","dd_no","ding_no","resMgr","loadNetUrl","avatar","room_setup_info","inning_num","squeeze_cards","midway_join","low_bet","hig_bet","node","active","group_id","requestJoin","sceneNode","js","showLoadingView","setTimeout","netMgr","request","rid","gid","ret","log","code","OK","hideLoadingView","USER_ALREAY_IN_OTHER_GAME","common","showMsgBox","type","msg","okCb","exec","gUserData","roomInfo","room_info","director","loadScene","bind"],"mappings":"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","file":"RoomInfoView.js","sourceRoot":"../../../../../../../../assets/scripts/app/lobby/view/JoinRoom","sourcesContent":["var BaseView = require(\"BaseView\")\nvar serverRoomDesc = require(\"JoinRoomConfig\").serverRoomDesc\nvar Code = require(\"Code\");\n\ncc.Class({\n  extends: BaseView,\n\n  properties: {\n\n  },\n\n  onLoad: function () {\n\n  },\n\n  setData: function (data) {\n    this.data = data\n\n    var nameString = data.owner_base_info.name\n    if (this.getNameStringCount(nameString) > 10)   //最多容纳5个汉字\n    {\n      nameString = nameString.substr(0, this.getNameStringCount(nameString, 8)) + \"..\"  //大于5个汉字,取前4个汉子字符加..表示\n    }\n    this.find(\"txtName\").string = nameString\n\n    this.find(\"txtUid\").string = i18n.dd_no + \"：\" + data.owner_base_info.ding_no\n    cc.resMgr.loadNetUrl(this.find(\"imgIcon\"), data.owner_base_info.avatar)\n\n\n\n    var room_setup_info = this.data.room_setup_info\n    // this.find(\"txt1\").string = \"局数:\" + serverRoomDesc[\"inning_limit_type\"][room_setup_info.inning_limit_type]\n    this.find(\"txt1\").string = \"局数:\" + room_setup_info.inning_num\n    this.find(\"txt2\").string = \"挤牌:\" + serverRoomDesc[\"squeeze_cards\"][room_setup_info.squeeze_cards]\n    this.find(\"txt3\").string = serverRoomDesc[\"midway_join\"][room_setup_info.midway_join]\n    // this.find(\"txt4\").string = \"押注:\" + serverRoomDesc[\"bet_limit_type\"][room_setup_info.bet_limit_type]\n    this.find(\"txt4\").string = \"押注:\" + room_setup_info.low_bet + \"-\" + room_setup_info.hig_bet\n    this.find(\"txtGroup\").node.active = room_setup_info.group_id == 0 ? false : true\n  },\n\n  requestJoin: function () {\n    cc.sceneNode.js.showLoadingView()\n    setTimeout(function () {\n      cc.netMgr.request(\"room_join\", { rid: this.data.rid , gid : this.data.room_setup_info.group_id}, function (ret) {\n        cc.log(\"room_join\", ret);\n        if (ret.code != Code.OK) {\n          cc.sceneNode.js.hideLoadingView()\n        }\n        //在丁丁的其他游戏中\n        if (Code.USER_ALREAY_IN_OTHER_GAME == ret.code) {\n          cc.common.showMsgBox({type: 2, msg: \"您正在游戏中\", okCb: function () {\n                  \n              }})\n          return\n        }\n        cc.netMgr.exec(ret, function () {\n          gUserData.roomInfo = ret.room_info\n          cc.director.loadScene(\"GameScene\")\n        }.bind(this))\n      }.bind(this))\n    }.bind(this), 10)\n  },\n});\n"]}