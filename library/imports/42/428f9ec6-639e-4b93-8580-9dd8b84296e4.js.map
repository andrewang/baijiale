{"version":3,"sources":["../../../../../../../../assets/scripts/app/game/view/BattleRecord/assets/scripts/app/game/view/BattleRecord/TotalBattleRecordItem.js"],"names":["BaseObj","require","serverRoomDesc","http","cc","Class","extends","properties","onLoad","node","on","Node","EventType","TOUCH_END","prent","sceneNode","js","find","view","openView","owner_base_info","data","seat_info_list","setData","reqGameRecord","rid","setPoint","txt","point","parseFloat","color","Color","WHITE","fromHEX","string","Math","abs","room_num","low_bet","hig_bet","max_inning_num","newDate","Date","setTime","open_room_time","formatDate","owner","nameString","name","getNameStringCount","substr","txtName","txtPoint","owner_profix","win_jetton","resMgr","loadNetUrl","avatar","i","player","active","getSeatInfo","uid","length","user_base_info","user_profix_list","sort","a","b","user_profit","nodeOwner","seatInfo","showMyselfBg","gUserData","bg_myself"],"mappings":"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","file":"TotalBattleRecordItem.js","sourceRoot":"../../../../../../../../assets/scripts/app/game/view/BattleRecord","sourcesContent":["var BaseObj = require(\"BaseObj\")\nvar serverRoomDesc = require(\"JoinRoomConfig\").serverRoomDesc\nvar http = require(\"Http\")\ncc.Class({\n    extends: BaseObj,\n\n    properties: {\n\n    },\n\n    onLoad: function () {\n        this.node.on(cc.Node.EventType.TOUCH_END, function () {\n            var prent = cc.sceneNode.js.find(\"singleBattleRecordNode\")\n            var view = cc.sceneNode.js.openView(\"prefabs/battleRecord/SingleBattleRecordView\", prent ? prent.node : null)\n            // view.owner_uid = this.data.owner_uid\n            view.owner_base_info = this.data.owner_base_info\n            view.seat_info_list = this.data.seat_info_list\n            view.setData(this.data)\n            view.reqGameRecord(this.data.rid)\n        }, this)\n    },\n\n    setPoint: function (txt, point) {\n        if (point >= 0) {\n            point = parseFloat(point)\n            txt.node.color = cc.Color.WHITE.fromHEX(\"#6DCFF6\")\n            txt.string = \"+\" + point\n        } else {\n            point = Math.abs(point)\n            point = parseFloat(point)\n            txt.node.color = cc.Color.WHITE.fromHEX(\"#ED1C24\")\n            txt.string = \"-\" + point\n        }\n    },\n\n    //data:room_record_info\n    setData: function (data) {\n        this.data = data\n        this.find(\"txtRoomId\").string = \"房间号:\" + data.room_num\n        // this.find(\"txtYazhu\").string = \"最低-最高:\" + serverRoomDesc[\"bet_limit_type\"][data.bet_limit_type]\n        this.find(\"txtYazhu\").string = data.low_bet + \"-\" + data.hig_bet\n        // this.find(\"txtJushu\").string = \"局数:\" + serverRoomDesc[\"inning_limit_type\"][data.inning_limit_type]\n        this.find(\"txtJushu\").string = \"局数:\" + data.max_inning_num\n        var newDate = new Date()\n        newDate.setTime(data.open_room_time * 1000)\n        // this.find(\"txtTime\").string = newDate.toLocaleString()\n        this.find(\"txtTime\").string = formatDate(newDate)\n        var owner = this.find(\"owner\").node\n        // owner.txtName.string = data.owner_uid\n\n        var nameString = data.owner_base_info.name\n        if (this.getNameStringCount(nameString) > 10) {\n            nameString = nameString.substr(0, this.getNameStringCount(nameString, 8)) + \"..\"\n        }\n        owner.txtName.string = nameString\n\n        // owner.txtPoint.string = data.owner_win_total\n        // owner.txtPoint.string = data.owner_profix.win_jetton\n        this.setPoint(owner.txtPoint, data.owner_profix.win_jetton)\n        // cc.resMgr.loadNetUrl(owner.imgIcon, data.owner_base_info.avatar)\n        cc.resMgr.loadNetUrl(this.find(\"owner\").find(\"imgIcon\"), data.owner_base_info.avatar)\n\n        for (var i = 1; i <= 9; i++) {\n            var player = this.find(\"player\" + i)\n            player.node.active = false\n        }\n\n        function getSeatInfo(uid) {\n            for (var i = 0; i < data.seat_info_list.length; i++) {\n                if (data.seat_info_list[i].user_base_info.uid == uid) {\n                    return data.seat_info_list[i]\n                }\n            }\n        }\n\n        data.user_profix_list.sort(function (a, b) {\n            return a.uid - b.uid\n        })\n        \n        for (var i = 0; i < data.user_profix_list.length; i++) {\n            var user_profit = data.user_profix_list[i]\n            var player = this.find(\"player\" + (i + 1))\n            player.node.active = true\n            player.node.nodeOwner.node.active = false\n            // player.node.txtName.string = user_profit.uid\n            var seatInfo = getSeatInfo(user_profit.uid)\n\n            var nameString = seatInfo.user_base_info.name\n            if (this.getNameStringCount(nameString) > 10) {\n                nameString = nameString.substr(0, this.getNameStringCount(nameString, 8)) + \"..\"\n            }\n            player.node.txtName.string = nameString\n\n            // player.node.txtPoint.string = user_profit.win_jetton\n            this.setPoint(player.node.txtPoint, user_profit.win_jetton)\n            // cc.resMgr.loadNetUrl(player.node.imgIcon, seatInfo.user_base_info.avatar)\n            cc.resMgr.loadNetUrl(player.find(\"imgIcon\"), seatInfo.user_base_info.avatar)\n        }\n\n        this.showMyselfBg()\n\n        //这里根据人数改变item的大小\n        // if (data.user_profix_list.length <= 3 && data.user_profix_list.length > 0) {\n        //     this.find(\"layoutPlayer\").setContentSize({width : 960, height : 240})\n        //     this.node.setContentSize({width : 960, height : 240})\n        // }\n        // else if (data.user_profix_list.length <= 6 && data.user_profix_list.length > 3) {\n        //     this.find(\"layoutPlayer\").setContentSize({width : 960, height : 310})\n        //     this.node.setContentSize({width : 960, height : 310})\n        // }\n        // else if (data.user_profix_list.length <= 9 && data.user_profix_list.length > 6)\n        // {\n        //     this.find(\"layoutPlayer\").setContentSize({width : 960, height : 400})\n        //     this.node.setContentSize({width : 960, height : 400})\n        // }\n        // else {\n        //     this.find(\"layoutPlayer\").setContentSize({width : 960, height : 150})\n        //     this.node.setContentSize({width : 960, height : 150})\n        // }\n    },\n\n    showMyselfBg: function () {\n        if (this.data.owner_profix.uid == gUserData.uid) {\n            this.find(\"owner\").node.bg_myself.node.active = true\n            return\n        }\n\n        for (var i = 0; i < this.data.user_profix_list.length; i++) {\n            var user_profit = this.data.user_profix_list[i]\n            var player = this.find(\"player\" + (i + 1))\n            if (user_profit.uid == gUserData.uid) {\n                player.node.bg_myself.node.active = true\n                return\n            }\n        }\n    },\n\n});\n"]}