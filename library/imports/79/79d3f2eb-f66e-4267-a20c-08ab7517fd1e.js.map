{"version":3,"sources":["../../../../../assets/scripts/common/assets/scripts/common/Common.js"],"names":["cc","Class","extends","Component","properties","onLoad","init","self","msgBoxUrl","msgBarUrl","msgbarList","loadPrefab","url","loader","loadRes","err","prefab","showMsgBox","params","type","msgBar","instantiate","parent","gNode","codeNumber","js","show","msg","push","length","popBar","adjustBar","bind","msgBox","setData","node","destroy","removeByIndex","i","position","x","y","isRepetitionBar","clearMsgBox"],"mappings":"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","file":"Common.js","sourceRoot":"../../../../../assets/scripts/common","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // msgBarPrefab: cc.Prefab,\n        // msgBoxPrefab: cc.Prefab,\n        // msgbarList: []\n    },\n\n    onLoad: function () {\n\n    },\n\n    init: function () {\n        var self = this\n        this.msgBoxUrl = \"prefabs/msgBox/MsgBox\"\n        this.msgBarUrl = \"prefabs/msgBox/MsgBar\"\n        this.msgbarList = []\n        function loadPrefab(url) {\n            cc.loader.loadRes(url, function (err, prefab) {\n                self[url] = prefab\n            })\n        }\n        loadPrefab(this.msgBoxUrl)\n        loadPrefab(this.msgBarUrl)\n    },\n\n    //param: {type : 1, msg : \"\", cb}\n    showMsgBox: function (params) {\n        if (1 == params.type) {\n            if (this[this.msgBarUrl]) {\n                var msgBar = cc.instantiate(this[this.msgBarUrl])\n                msgBar.parent = cc.gNode\n                if (params.codeNumber) {\n                    msgBar.codeNumber = params.codeNumber\n                }\n                else {\n                    msgBar.codeNumber = -1\n                }\n                msgBar.js.show(params.msg)\n                this.msgbarList.push(msgBar)\n                if (this.msgbarList.length > 5) {\n                    this.popBar()\n                }\n                this.adjustBar()\n            }\n            else {\n                cc.loader.loadRes(this.msgBarUrl, function (err, prefab) {\n                    var msgBar = cc.instantiate(prefab)\n                    msgBar.parent = cc.gNode\n                    if (params.codeNumber) {\n                        msgBar.codeNumber = params.codeNumber\n                    }\n                    else {\n                        msgBar.codeNumber = -1\n                    }\n                    msgBar.js.show(params.msg)\n                    this.msgbarList.push(msgBar)\n                    if (this.msgbarList.length > 5) {\n                        this.popBar()\n                    }\n                    this.adjustBar()\n                }.bind(this))\n            }\n\n        } else if (2 == params.type) {\n            if (this[this.msgBoxUrl]) {\n                if (!this.msgBox){  //msgbox只存在一个，如再有生成只刷新内容\n                    this.msgBox = cc.instantiate(this[this.msgBoxUrl])\n                    this.msgBox.parent = cc.gNode\n                }\n                this.msgBox.js.setData(params)\n            }\n            else {\n                cc.loader.loadRes(this.msgBoxUrl, function (err, prefab) {\n                    if (!this.msgBox) {\n                        this.msgBox = cc.instantiate(this[this.msgBoxUrl])\n                        this.msgBox.parent = cc.gNode\n                    }\n                    msgBox.js.setData(params)\n                }.bind(this))\n            }\n        }\n\n    },\n\n    //移除一个消息条\n    popBar: function () {\n        if (this.msgbarList.length > 0) {\n            this.msgbarList[0].js.node.destroy()\n            removeByIndex(this.msgbarList, 0)\n        }\n    },\n\n    adjustBar: function () {\n        for (var i = 0; i < this.msgbarList.length; i++) {\n            this.msgbarList[i].js.node.position = { x: 0, y: 80 * (this.msgbarList.length - i - 1) }\n        }\n    },\n\n    //是否有重复提示\n    isRepetitionBar: function (codeNumber) {\n        for (var i = 0; i < this.msgbarList.length; i++) {\n            if (this.msgbarList[i].codeNumber == codeNumber)\n            {\n                return true\n            }\n        }\n        return false\n    },\n\n    //同步清除msgBox\n    clearMsgBox: function () {\n        this.msgBox = null\n    }\n});\n"]}