{"version":3,"sources":["../../../../../../../../assets/scripts/app/game/view/BattleRecord/assets/scripts/app/game/view/BattleRecord/SingleBattleRecordItem.js"],"names":["BaseObj","require","serverRoomDesc","http","cc","Class","extends","properties","onLoad","setPoint","txt","point","parseFloat","node","color","Color","WHITE","fromHEX","string","Math","abs","setData","data","txtXianPoint","find","txtZhuangPoint","player_points","banker_points","i","state_info","state_list","newDate","Date","setTime","open_inning_time","formatDate","owner","nameString","owner_base_info","name","getNameStringCount","substr","txtName","txtPoint","owner_profix","win_jetton","resMgr","loadNetUrl","avatar","inning_count","player","active","getSeatInfo","uid","seat_info_list","length","user_base_info","bind","user_profix_list","sort","a","b","user_profit","nodeOwner","seatInfo","showMyselfBg","gUserData","bg_myself"],"mappings":"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","file":"SingleBattleRecordItem.js","sourceRoot":"../../../../../../../../assets/scripts/app/game/view/BattleRecord","sourcesContent":["var BaseObj = require(\"BaseObj\")\nvar serverRoomDesc = require(\"JoinRoomConfig\").serverRoomDesc\nvar http = require(\"Http\")\ncc.Class({\n    extends: BaseObj,\n\n    properties: {\n        \n    },\n\n    onLoad: function () {\n        \n    },\n\n    setPoint: function (txt, point) {\n        if (point >= 0) {\n            point = parseFloat(point)\n            txt.node.color = cc.Color.WHITE.fromHEX(\"#6DCFF6\")\n            txt.string = \"+\" + point\n        } else {\n            point = Math.abs(point)\n            point = parseFloat(point)\n            txt.node.color = cc.Color.WHITE.fromHEX(\"#ED1C24\")\n            txt.string = \"-\" + point\n        }\n    },\n\n    //data:inning_record_info\n    setData: function (data) {\n        this.data = data\n        \n        var txtXianPoint = this.find(\"txtXianPoint\")\n        var txtZhuangPoint = this.find(\"txtZhuangPoint\")\n        \n        txtXianPoint.string = data.player_points\n        txtZhuangPoint.string = data.banker_points\n        \n        txtXianPoint.node.color = cc.Color.WHITE.fromHEX(\"#BFCDFF\")\n        txtZhuangPoint.node.color = cc.Color.WHITE.fromHEX(\"#BFCDFF\")\n\n        for (let i in data.state_info.state_list)\n        {\n            if (data.state_info.state_list[i] == 6)\n                txtZhuangPoint.node.color = cc.Color.WHITE.fromHEX(\"#FFF799\")\n            if (data.state_info.state_list[i] == 7)\n                txtXianPoint.node.color = cc.Color.WHITE.fromHEX(\"#FFF799\")\n        }\n        // for (var i = 1; i <= 3; i++) {\n        //     this.find(\"x\" + i).active = false\n        //     this.find(\"z\" + i).active = false\n        // }\n        // for (var i = 0; i < data.player_cards_list.length; i++) {\n        //     var cards_info = data.player_cards_list[i]\n        //     this.find(\"x\" + (i + 1)).active = true\n        //     cc.resMgr.updateSprite(this.find(\"xsp\" + (i + 1)), cc.resMgr.getCardResResultName({type : cards_info.type, num : cards_info.cards}))\n        // }\n        // for (var i = 0; i < data.banker_cards_list.length; i++) {\n        //     var cards_info = data.banker_cards_list[i]\n        //     this.find(\"z\" + (i + 1)).active = true\n        //     cc.resMgr.updateSprite(this.find(\"zsp\" + (i + 1)), cc.resMgr.getCardResResultName({type : cards_info.type, num : cards_info.cards}))\n        // }\n\n        var newDate = new Date()\n        newDate.setTime(data.open_inning_time * 1000)\n        // this.find(\"txtTime\").string = newDate.toLocaleString()\n        this.find(\"txtTime\").string = formatDate(newDate)\n        var owner = this.find(\"owner\").node\n        // owner.txtName.string = this.owner_uid\n\n        var nameString = this.owner_base_info.name\n        if (this.getNameStringCount(nameString) > 10) {\n            nameString = nameString.substr(0, this.getNameStringCount(nameString, 8)) + \"..\"\n        }\n        owner.txtName.string = nameString\n\n        // owner.txtPoint.string = data.owner_profix.win_jetton\n        this.setPoint(owner.txtPoint, data.owner_profix.win_jetton)\n        cc.resMgr.loadNetUrl(this.find(\"owner\").find(\"imgIcon\"), this.owner_base_info.avatar)\n        this.find(\"txtJu\").string = data.inning_count\n\n        for (var i = 1; i <= 9; i++) {\n            var player = this.find(\"player\" + i)\n            player.node.active = false\n        }\n\n        var getSeatInfo = function (uid) {\n            for (var i = 0; i < this.seat_info_list.length; i++) {\n                if (this.seat_info_list[i].user_base_info.uid == uid) {\n                    return this.seat_info_list[i]\n                }\n            }\n        }.bind(this)\n\n        data.user_profix_list.sort(function (a,b) {\n            return a.uid - b.uid\n        })\n        for (var i = 0; i < data.user_profix_list.length; i++) {\n            var user_profit = data.user_profix_list[i]\n            var player = this.find(\"player\" + (i + 1))\n            player.node.active = true\n            player.node.nodeOwner.node.active = false\n            // player.node.txtName.string = user_profit.uid\n            var seatInfo = getSeatInfo(user_profit.uid)\n\n            var nameString = seatInfo.user_base_info.name\n            if (this.getNameStringCount(nameString) > 10)\n            {\n                nameString = nameString.substr(0, this.getNameStringCount(nameString, 8)) + \"..\"\n            }\n            player.node.txtName.string = nameString\n\n            // player.node.txtPoint.string = user_profit.win_jetton\n            this.setPoint(player.node.txtPoint, user_profit.win_jetton)\n            cc.resMgr.loadNetUrl(player.find(\"imgIcon\"), seatInfo.user_base_info.avatar)\n        }\n\n        this.showMyselfBg()\n\n        //这里根据人数改变item的大小\n        // if (data.user_profix_list.length <= 3 && data.user_profix_list.length > 0) {\n        //     this.find(\"layoutPlayer\").setContentSize({width : 960, height : 250})\n        //     this.node.setContentSize({width : 960, height : 250})\n        // }\n        // else if (data.user_profix_list.length <= 6 && data.user_profix_list.length > 3) {\n        //     this.find(\"layoutPlayer\").setContentSize({width : 960, height : 330})\n        //     this.node.setContentSize({width : 960, height : 330})\n        // }\n        // else if (data.user_profix_list.length <= 9 && data.user_profix_list.length > 6)\n        // {\n        //     this.find(\"layoutPlayer\").setContentSize({width : 960, height : 420})\n        //     this.node.setContentSize({width : 960, height : 420})\n        // }\n        // else {\n        //     this.find(\"layoutPlayer\").setContentSize({width : 960, height : 170})\n        //     this.node.setContentSize({width : 960, height : 170})\n        // }\n    },\n\n    showMyselfBg: function () {\n        if (this.data.owner_profix.uid == gUserData.uid) {\n            this.find(\"owner\").node.bg_myself.node.active = true\n            return\n        }\n\n        for (var i = 0; i < this.data.user_profix_list.length; i++) {\n            var user_profit = this.data.user_profix_list[i]\n            var player = this.find(\"player\" + (i + 1))\n            if (user_profit.uid == gUserData.uid) {\n                player.node.bg_myself.node.active = true\n                return\n            }\n        }\n    },\n\n});\n"]}